# –ó–∞–¥–∞–Ω–∏–µ ‚Ññ5
# üìå –î–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–¥–∞—á—É 4.
# üìå –î–æ–±–∞–≤—å—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
# üìå –ü—Ä–∏ —ç—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ª—é–±–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å. –í
# —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±–µ—Ä—ë—Ç—Å—è –ø–µ—Ä–≤—ã–π –≤ –º–µ—Å—è—Ü–µ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —Ç–µ–∫—É—â–∏–π
# –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –∏/–∏–ª–∏ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü.


import re
import argparse
from datetime import datetime, timedelta
import logging

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–∞–π–ª
logging.basicConfig(filename='errors_5.log', level=logging.ERROR, format='%(asctime)s - %(levelname)s - %(message)s')

def get_date_from_text(week_number, weekday, month):
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Å—è—Ü—ã –∏ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏
    months = {
        "—è–Ω–≤–∞—Ä—è": 1,
        "—Ñ–µ–≤—Ä–∞–ª—è": 2,
        "–º–∞—Ä—Ç–∞": 3,
        "–∞–ø—Ä–µ–ª—è": 4,
        "–º–∞—è": 5,
        "–∏—é–Ω—è": 6,
        "–∏—é–ª—è": 7,
        "–∞–≤–≥—É—Å—Ç–∞": 8,
        "—Å–µ–Ω—Ç—è–±—Ä—è": 9,
        "–æ–∫—Ç—è–±—Ä—è": 10,
        "–Ω–æ—è–±—Ä—è": 11,
        "–¥–µ–∫–∞–±—Ä—è": 12
    }

    weekdays = {
        "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": 0,
        "–≤—Ç–æ—Ä–Ω–∏–∫": 1,
        "—Å—Ä–µ–¥–∞": 2,
        "—á–µ—Ç–≤–µ—Ä–≥": 3,
        "–ø—è—Ç–Ω–∏—Ü–∞": 4,
        "—Å—É–±–±–æ—Ç–∞": 5,
        "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ": 6
    }

    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —á–∏—Å–ª–æ–≤—ã–µ
    if isinstance(month, str):
        month = months.get(month, int(month))  # –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–æ
    if isinstance(weekday, str):
        weekday = weekdays.get(weekday, int(weekday))  # –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–æ

    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥
    current_year = datetime.now().year

    # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –∑–∞–¥–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
    if month is None:
        month = datetime.now().month
    if weekday is None:
        weekday = datetime.now().weekday()
    if week_number is None:
        week_number = 1  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é

    # –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—É—é –¥–∞—Ç—É –º–µ—Å—è—Ü–∞
    first_day_of_month = datetime(current_year, month, 1)

    # –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—ã–π –Ω—É–∂–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤ –º–µ—Å—è—Ü–µ
    days_to_add = (weekday - first_day_of_month.weekday() + 7) % 7
    first_weekday = first_day_of_month + timedelta(days=days_to_add)

    # –ù–∞—Ö–æ–¥–∏–º –Ω—É–∂–Ω—ã–π –ø–æ –ø–æ—Ä—è–¥–∫—É –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
    target_date = first_weekday + timedelta(weeks=week_number - 1)

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã—à–ª–∏ –ª–∏ –º—ã –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –º–µ—Å—è—Ü–∞
    if target_date.month != month:
        logging.error(f"–î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –º–µ—Å—è—Ü–∞: –Ω–µ–¥–µ–ª—è {week_number}, –¥–µ–Ω—å {weekday}, –º–µ—Å—è—Ü {month}")
        return None

    return target_date

def main():
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    parser = argparse.ArgumentParser(description='–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –≤ –¥–∞—Ç—É.')
    parser.add_argument('--week', type=int, help='–ù–æ–º–µ—Ä –Ω–µ–¥–µ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)')
    parser.add_argument('--weekday', type=str, help='–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" –∏–ª–∏ "0" –¥–ª—è –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞)')
    parser.add_argument('--month', type=str, help='–ú–µ—Å—è—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—è–Ω–≤–∞—Ä—è" –∏–ª–∏ "1" –¥–ª—è —è–Ω–≤–∞—Ä—è)')

    args = parser.parse_args()

    # –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É –∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    date_result = get_date_from_text(args.week, args.weekday, args.month)

    if date_result:
        print(f"–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–∞—è –¥–∞—Ç–∞: {date_result.strftime('%Y-%m-%d')}")
    else:
        logging.error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞—Ç—É.")

if __name__ == "__main__":
    main()
